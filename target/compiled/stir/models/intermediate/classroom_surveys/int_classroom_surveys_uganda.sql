

select
"_airbyte_unique_key",
  "e3",
  "n1",
  "n2",
  "n3",
  "n4",
  "s4",
  "KEY",
  "cc1",
  "cc2",
  "cc3",
  "cc4",
  "cc5",
  "se4",
  "se5",
  "cro1",
  "cro2",
  "cro3",
  "cro4",
  "cro5",
  "cro7",
  "cro8",
  "cro9",
  "cro10",
  "cro11",
  "cro12",
  "cro7a",
  "cro8a",
  "caseid",
  "cro13a",
  "cro13b",
  "cro13c",
  "n_seca",
  "n_secc",
  "plname",
  "endtime",
  "meeting",
  "n1_secd",
  "n1_sece",
  "n2_sece",
  "n3_sece",
  "n4_sece",
  "n5_sece",
  "remarks",
  "deviceid",
  "duration",
  "expected",
  "username",
  "starttime",
  "instanceid",
  "device_info",
  "malepresent",
  "coach_gender",
  "forms_uganda",
  "femalepresent",
  "observer_role",
  "review_status",
  "role_coaching",
  "completiondate",
  "submissiondate",
  "coachee_gender",
  "devicephonenum",
  "review_quality",
  "teacher_gender",
  "district_busoga",
  "district_kigezi",
  "district_masaka",
  "education_level",
  "formdef_version",
  "location_uganda",
  "observer_gender",
  "district_bunyoro",
  "district_central",
  "facilitator_role",
  "meeting_coaching",
  "observation_term",
  "remarks_coaching",
  "district_rwenzori",
  "duration_coaching",
  "name_of_the_coach",
  "remarks_classroom",
  "facilitator_gender",
  "name_of_the_coachee",
  "cro13aiii_growth_mindset",
  "cro13aiii_worked_examples",
  "facilitator_role_coaching",
  "cro13aiii_retrieval_practices",
  "cro13aiii_elaborative_questioning",
  "cro13aiii_asking_effective_questions",
  "cro13aiii_physical_learning_environment",
  "cro13aiii_emotional_learning_environment",
  "_airbyte_ab_id",
  "_airbyte_emitted_at",
  "_airbyte_normalized_at",
  "_airbyte_uganda_bm_2022_hashid",
'Uganda' AS country, location_uganda AS region, coalesce (district_bunyoro,district_kigezi,
    district_masaka, district_rwenzori, district_central) as sub_region,
    COALESCE(s1, cro1) as s1,
 COALESCE(s2, cro2) as s2,  COALESCE(s3, cro3) as s3, COALESCE(cro4, e1) as e1, COALESCE(cro5, e2) as e2, COALESCE(cro7, c1) as c1,
 COALESCE(cro7a, c1a) as c1a, COALESCE(cro8, c2) as c2, COALESCE(cro8a, c2a) as c2a, COALESCE(cro10, se1) as se1,
 COALESCE(cro11, se2) as se2, COALESCE(cro12, se3) as se3, to_date(coalesce(date,date_coaching), 'Mon, DD YYYY') as observation_date
from "postgres"."staging"."uganda_bm_2022"